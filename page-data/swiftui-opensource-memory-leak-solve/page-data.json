{"componentChunkName":"component---src-templates-post-jsx","path":"/swiftui-opensource-memory-leak-solve/","result":{"data":{"site":{"siteMetadata":{"title":"myunggon"}},"markdownRemark":{"id":"050f3c55-aa6a-53d0-b9c7-2a747e669f52","excerpt":"ì´ ê¸€ì€ ì´ì „ ë¸”ë¡œê·¸ì—ì„œ ì´ì „í•œ ê¸€ì…ë‹ˆë‹¤. ì´ì „í•˜ëŠ” ê³¼ì •ì—ì„œ ë‚´ìš©ì„ ìˆ˜ì • ë° ë³´ì™„í•˜ì˜€ìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ ì•Œë¦¼ì„ ìœ„í•œ Popup ë·° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë„ì…í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê°œë°œ ì§„í–‰ ì¤‘ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì— ì´ìƒì„ ëŠë¼ê³  ë©”ëª¨ë¦¬ ê·¸ë˜í”„ë¥¼ ë¶„ì„í•˜ë˜ ì¤‘ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ ë°œê²¬í•˜ì˜€ìŠµë‹ˆë‹¤. ë¶„ì„ ê²°ê³¼ ë„ì…í•˜ê²Œ ëœ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ retain cyclâ€¦","html":"<blockquote>\n<p>ì´ ê¸€ì€ ì´ì „ ë¸”ë¡œê·¸ì—ì„œ ì´ì „í•œ ê¸€ì…ë‹ˆë‹¤. ì´ì „í•˜ëŠ” ê³¼ì •ì—ì„œ ë‚´ìš©ì„ ìˆ˜ì • ë° ë³´ì™„í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n</blockquote>\n<p>í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ ì•Œë¦¼ì„ ìœ„í•œ Popup ë·° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë„ì…í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê°œë°œ ì§„í–‰ ì¤‘ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì— ì´ìƒì„ ëŠë¼ê³  ë©”ëª¨ë¦¬ ê·¸ë˜í”„ë¥¼ ë¶„ì„í•˜ë˜ ì¤‘ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ ë°œê²¬í•˜ì˜€ìŠµë‹ˆë‹¤. ë¶„ì„ ê²°ê³¼ ë„ì…í•˜ê²Œ ëœ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ retain cycle ë¬¸ì œê°€ ë°œìƒí•œ ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„ì… í›„ ë§ì€ ë¶€ë¶„ì— ì ìš©ë˜ê³  ìˆì–´ ëŒ€ì²´í•˜ê¸° ì–´ë µë‹¤ê³  ìƒê°í•˜ì—¬ ì´ìŠˆë¥¼ ì§ì ‘ í•´ê²°í•´ë³´ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ì½”ë“œ-êµ¬ì¡°\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-%EA%B5%AC%EC%A1%B0\" aria-label=\"ì½”ë“œ êµ¬ì¡° permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ì½”ë“œ êµ¬ì¡°</h2>\n<p>ë¬¸ì œ ìƒí™©ì„ ë³´ê¸° ì „ í˜„ì¬ ì½”ë“œ êµ¬ì¡°ë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<p>ğŸ“‚ <a href=\"https://github.com/exyte/PopupView/blob/master/Sources/PopupView/FullscreenPopup.swift\"><code class=\"language-text\">FullscreenPopup.swift</code></a></p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">FullscreenPopup</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Item</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">Equatable</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PopupContent</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">ViewModifier</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token operator\">...</span>\n    <span class=\"token keyword\">var</span> autohideIn<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Double</span><span class=\"token operator\">?</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> dispatchWorkHolder <span class=\"token operator\">=</span> <span class=\"token class-name\">DispatchWorkHolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token attribute atrule\">@State</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> dismissSource<span class=\"token punctuation\">:</span> <span class=\"token class-name\">DismissSource</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">body</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Content</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token operator\">...</span>\n\t\t<span class=\"token function\">appearAction</span><span class=\"token punctuation\">(</span>sheetPresented<span class=\"token punctuation\">:</span> newValue <span class=\"token operator\">!=</span> <span class=\"token nil constant\">nil</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">appearAction</span><span class=\"token punctuation\">(</span>sheetPresented<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> sheetPresented <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token operator\">...</span>\n\t\t<span class=\"token function\">setupAutohide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token operator\">...</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">setupAutohide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> autohideIn <span class=\"token operator\">=</span> autohideIn <span class=\"token punctuation\">{</span>\n\t\tdispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token operator\">=</span> <span class=\"token class-name\">DispatchWorkItem</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> isPresentedRef<span class=\"token punctuation\">,</span> <span class=\"token keyword\">weak</span> itemRef<span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n\t\t\t<span class=\"token operator\">...</span>\n\t\t\tdismissSource <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>autohide\n\t\t\t<span class=\"token operator\">...</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\t\t<span class=\"token keyword\">if</span> sheetPresented<span class=\"token punctuation\">,</span> <span class=\"token keyword\">let</span> work <span class=\"token operator\">=</span> dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token class-name\">DispatchQueue</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span><span class=\"token function\">asyncAfter</span><span class=\"token punctuation\">(</span>deadline<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> autohideIn<span class=\"token punctuation\">,</span> execute<span class=\"token punctuation\">:</span> work<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ğŸ“‚ <a href=\"https://github.com/exyte/PopupView/blob/master/Sources/PopupView/Utils.swift\"><code class=\"language-text\">Utils.swift</code></a></p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DispatchWorkHolder</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> work<span class=\"token punctuation\">:</span> <span class=\"token class-name\">DispatchWorkItem</span><span class=\"token operator\">?</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">DispatchWorkHolder</code>ê°ì²´ëŠ” ìˆ˜í–‰í•  ë¸”ë¡ì„ ê°€ì§€ëŠ” ê°ì²´ì…ë‹ˆë‹¤. <code class=\"language-text\">autohideIn</code> ë³€ìˆ˜ê°€ ê°’ì„ ê°€ì§€ê³  ìˆì„ ë•Œ, í˜„ì¬ ë‚˜íƒ€ë‚œ íŒì—… ë·°ê°€ ì‚¬ë¼ì§€ë„ë¡ <code class=\"language-text\">dismisSource</code>ë¥¼ <code class=\"language-text\">.autohide</code>ë¡œ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜ ë¸”ë¡ì„ ìƒì„±í•˜ì—¬ <code class=\"language-text\">DispatchWorkHolder</code> ë‚´ë¶€ <code class=\"language-text\">DispatchWorkItem</code>ì„ êµì²´í•©ë‹ˆë‹¤. ì´í›„ <code class=\"language-text\">autohideIn</code>ì˜ ê°’ë§Œí¼ì˜ ì‹œê°„ì´ ì§€ë‚œ í›„ ì´ í•¨ìˆ˜ ë¸”ë¡ì„ ì‹¤í–‰í•˜ë„ë¡ ìŠ¤ì¼€ì¤„ë§í•©ë‹ˆë‹¤.</p>\n<h2 id=\"ë¬¸ì œ-ìƒí™©\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\" aria-label=\"ë¬¸ì œ ìƒí™© permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ë¬¸ì œ ìƒí™©</h2>\n<p>í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ìë“¤ì˜ ì‚¬ì§„ ë° ì˜ìƒì„ í”¼ë“œ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. í”¼ë“œ í˜ì´ì§€ì—ì„œ í•¸ë“œí° ë°œì—´ì´ ìƒê¸°ê³  ì•±ì´ í¬ë˜ì‹œë‚˜ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ë°œìƒí•˜ì—¬ ì´ë¥¼ í•´ê²°í•˜ê³ ì ì•±ì„ ë¶„ì„í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤. <code class=\"language-text\">Debug Navigator</code>ë¥¼ í†µí•´ CPUì™€ ë©”ëª¨ë¦¬ë¥¼ ë¶„ì„í•˜ë˜ ì¤‘ ë©”ëª¨ë¦¬ê°€ ê³„ì†í•´ì„œ ì¦ê°€í•˜ëŠ” í˜„ìƒì„ ë°œìƒí•˜ì—¬ ì´ë¥¼ ë¶„ì„í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ë¶„ì„-ë„êµ¬ë¥¼-í†µí•œ-ë©”ëª¨ë¦¬-ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EB%B6%84%EC%84%9D-%EB%8F%84%EA%B5%AC%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%B6%84%EC%84%9D\" aria-label=\"ë¶„ì„ ë„êµ¬ë¥¼ í†µí•œ ë©”ëª¨ë¦¬ ë¶„ì„ permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ë¶„ì„ ë„êµ¬ë¥¼ í†µí•œ ë©”ëª¨ë¦¬ ë¶„ì„</h2>\n<p>Xcodeì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆëŠ” ë„êµ¬ëŠ” ë‘ ê°€ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\n<ul>\n<li>Memory Graph</li>\n<li>Instruments</li>\n</ul>\n<p>ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë¶„ì„í•˜ê¸° ìœ„í•´ì„œ í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œ í›„ ë©”ëª¨ë¦¬ ê·¸ë˜í”„ ë° Instrumentsì˜ Leaks í…œí”Œë¦¿ì„ í™œìš©í•˜ì—¬ í˜„ì¬ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ì–´ë–»ê²Œ ë°œìƒí•˜ê³  ìˆëŠ”ì§€ ë¶„ì„í•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<h3 id=\"Memory-Graph\" style=\"position:relative;\"><a href=\"#Memory-Graph\" aria-label=\"Memory Graph permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Memory Graph</h3>\n<p>![Simple retain cycle][./memory-graph-retain-cycle.png]</p>\n<p><code class=\"language-text\">Memory Graph</code>ëŠ” ê°ì²´ì˜ ìœ ë¬´ì™€ ê´€ê³„ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆëŠ” ë””ë²„ê¹… ë„êµ¬ ì…ë‹ˆë‹¤. ì•±ì´ ì‹¤í–‰ëœ í›„ íŠ¹ì • ì‹œì ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ì™€ ê°ì²´ë“¤ì˜ ì°¸ì¡° ê´€ê³„ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒì—…ì´ ëœ¨ê³  ì‚¬ë¼ì§„ í›„ì˜ ì‹œì ìœ¼ë¡œ retain cycleì´ ë‹¤ìŒê³¼ ê°™ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ ë¶„ì„í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<h3 id=\"Instruments\" style=\"position:relative;\"><a href=\"#Instruments\" aria-label=\"Instruments permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Instruments</h3>\n<p>![[./Instruments-leaks.png]]\nInstrumentsì˜ LeaksëŠ” ì•±ì´ ì‹¤í–‰ë˜ë©´ì„œ ëˆ„ìˆ˜\bë¡œ ì˜ì‹¬ë˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ì„œ ì•Œë ¤ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤. ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì²´ì˜ ê´€ê³„ë¥¼ ì¶”ì í•˜ë©´ì„œ í•´ì œê°€ ë˜ì§€ ì•ŠëŠ” ë¸”ë¡ì„ ë³´ì—¬ì£¼ëŠ” íˆ´ì…ë‹ˆë‹¤. ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¡œ ì˜ì‹¬ë˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¬í˜„í•˜ì—¬ ì–´ëŠ ì‹œì ì— ëˆ„ìˆ˜ê°€ ì˜ì‹¬ë˜ëŠ”ì§€ì™€ ì–´ë–¤ ê°ì²´ê°€ í• ë‹¹ í•´ì œê°€ ë˜ì§€ ì•ŠëŠ”ì§€ íŒŒì•…í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ì½”ë“œ-ë¶„ì„\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D\" aria-label=\"ì½”ë“œ ë¶„ì„ permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ì½”ë“œ ë¶„ì„</h2>\n<p>í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ì‘ì„±í•˜ê³  ë¬¸ì œ ìƒí™©ì„ ì¬í˜„í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ì •í™•í•œ ë¬¸ì œ ìƒí™©ì„ íŒŒì•…í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<h3 id=\"ìƒí™©-1\" style=\"position:relative;\"><a href=\"#%EC%83%81%ED%99%A9-1\" aria-label=\"ìƒí™© 1 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ìƒí™© 1</h3>\n<p>íŒì—…ì€ í‘œì‹œ ì—¬ë¶€ë¥¼ ì™¸ë¶€ ìƒíƒœ ê°’ì„ Bindingí•©ë‹ˆë‹¤. ì´ë•Œ ì™¸ë¶€ ìƒíƒœ ê°’ì„ <code class=\"language-text\">@State</code>ë°”ì¸ë”© í–ˆì„ ë•Œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ëŠ” ë°œìƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">ContentView</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token attribute atrule\">@State</span> <span class=\"token keyword\">var</span> isShowingPopup <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">popup</span><span class=\"token punctuation\">(</span>isPresented<span class=\"token punctuation\">:</span> $isShowingPopup<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t        <span class=\"token operator\">...</span>\n        <span class=\"token punctuation\">}</span> customize<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token short-argument\">$0</span><span class=\"token punctuation\">.</span><span class=\"token function\">autohideIn</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ìƒí™©-2\" style=\"position:relative;\"><a href=\"#%EC%83%81%ED%99%A9-2\" aria-label=\"ìƒí™© 2 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ìƒí™© 2</h3>\n<p>ë°˜ë©´ ì™¸ë¶€ ê°ì²´ì˜ ìƒíƒœê°’ì— Bindingì„ í•˜ê²Œ ë˜ë©´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” ViewModelì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— í˜„ì¬ ìƒí™©ê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewModel</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">ObservableObject</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token attribute atrule\">@Published</span> <span class=\"token keyword\">var</span> isShowingPopup <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">ContentView</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token attribute atrule\">@State</span> <span class=\"token keyword\">var</span> viewModel <span class=\"token operator\">=</span> <span class=\"token class-name\">ViewModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">var</span> body<span class=\"token punctuation\">:</span> <span class=\"token keyword\">some</span> <span class=\"token class-name\">View</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">popup</span><span class=\"token punctuation\">(</span>isPresented<span class=\"token punctuation\">:</span> $viewModel<span class=\"token punctuation\">.</span>isShowingPopup<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t        <span class=\"token operator\">...</span>\n        <span class=\"token punctuation\">}</span> customize<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token short-argument\">$0</span><span class=\"token punctuation\">.</span><span class=\"token function\">autohideIn</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">autohideIn</code> í•¨ìˆ˜ ë‚´ë¶€ì˜ í´ë¡œì €ê°€ <code class=\"language-text\">self</code>ë¥¼ ìº¡ì²˜í•˜ë©´ì„œ <code class=\"language-text\">FullScreenPopup</code> ë‚´ë¶€ì˜ ê°ì²´ ëª¨ë‘ referece countê°€ 1 ì¦ê°€í•˜ë©´ì„œ ì‚¬ì´í´ì´ ë‹«íˆëŠ” í˜„ìƒì´ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"í•´ê²°-ë°©ë²•-ì¶”ë¡ \" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95-%EC%B6%94%EB%A1%A0\" aria-label=\"í•´ê²° ë°©ë²• ì¶”ë¡  permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>í•´ê²° ë°©ë²• ì¶”ë¡ </h2>\n<p>ì‚¬ì´í´ì„ ëŠëŠ” ë°©ë²•ìœ¼ë¡œ ì„¸ ê°€ì§€ ì •ë„ì˜ í•´ê²° ë°©ì•ˆì„ ìƒê°í–ˆìŠµë‹ˆë‹¤.</p>\n<ul>\n<li>referenceë¥¼ ê°€ì§€ì§€ ì•ŠëŠ” ê°ì²´ë¡œ ë³€ê²½ (class -> struct)</li>\n<li>ì•½í•œ ì°¸ì¡°(weak self)</li>\n<li>ì§ì ‘ í• ë‹¹ í•´ì œ</li>\n</ul>\n<h3 id=\"Solution2-class--structë¡œ-ë³€ê²½\" style=\"position:relative;\"><a href=\"#Solution2-class--struct%EB%A1%9C-%EB%B3%80%EA%B2%BD\" aria-label=\"Solution2 class  structë¡œ ë³€ê²½ permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Solution2. class â†’ structë¡œ ë³€ê²½</h3>\n<p><code class=\"language-text\">DispatchWorkHolder</code>ëŠ” classì´ë©° ì°¸ì¡° íƒ€ì…ì´ê¸° ë•Œë¬¸ì— Reference countë¥¼ ì¦ê°€ì‹œí‚µë‹ˆë‹¤. ë•Œë¬¸ì— ë‹¨ìˆœí•˜ê²Œ ê°’ íƒ€ì…ì¸ structë¡œ ë³€ê²½í•œë‹¤ë©´ í•´ê²°í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ìƒê°í•˜ì—¬ <code class=\"language-text\">DispatchWorkHolder</code>ë¥¼ structë¡œ ë°”ê¿”ë³´ì•˜ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">DispatchWorkHolder</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> work<span class=\"token punctuation\">:</span> <span class=\"token class-name\">DispatchWorkItem</span><span class=\"token operator\">?</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">FullscreenPopup</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Item</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">Equatable</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">PopupContent</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">View</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">ViewModifier</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    \n    <span class=\"token comment\">/// holder for autohiding dispatch work (to be able to cancel it when needed)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> dispatchWorkHolder <span class=\"token operator\">=</span> <span class=\"token class-name\">DispatchWorkHolder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token comment\">// ...</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">setupAutohide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// if needed, dispatch autohide and cancel previous one</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> autohideIn <span class=\"token operator\">=</span> autohideIn <span class=\"token punctuation\">{</span>\n            dispatchWorkHolder<span class=\"token punctuation\">.</span>work<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\">// Weak reference to avoid the work item capturing the struct,</span>\n            <span class=\"token comment\">// which would create a retain cycle with the work holder itself.</span>\n\n            dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token operator\">=</span> <span class=\"token class-name\">DispatchWorkItem</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> isPresentedRef<span class=\"token punctuation\">,</span> <span class=\"token keyword\">weak</span> itemRef<span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n                isPresentedRef<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>wrappedValue <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n                itemRef<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>wrappedValue <span class=\"token operator\">=</span> <span class=\"token nil constant\">nil</span>\n                dismissSource <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>autohide\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> sheetPresented<span class=\"token punctuation\">,</span> <span class=\"token keyword\">let</span> work <span class=\"token operator\">=</span> dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token punctuation\">{</span>\n                <span class=\"token class-name\">DispatchQueue</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span><span class=\"token function\">asyncAfter</span><span class=\"token punctuation\">(</span>deadline<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> autohideIn<span class=\"token punctuation\">,</span> execute<span class=\"token punctuation\">:</span> work<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>í•˜ì§€ë§Œ ì œê°€ ê°„ê³¼í•œ ê²ƒì´ ìˆì—ˆëŠ”ë°, êµ¬ì¡°ì²´ëŠ” ë‚´ë¶€ í”„ë¡œí¼í‹°ì˜ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í”„ë¡œí¼í‹°ë¥¼ ê°€ì§€ëŠ” <code class=\"language-text\">FullscreenPopup</code>ì´ êµ¬ì¡°ì²´ì´ê¸° ë•Œë¬¸ì— ì´ëŠ” í•´ê²° ë°©ë²•ì´ ë  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤.</p>\n<h3 id=\"Sloution2-weak-self\" style=\"position:relative;\"><a href=\"#Sloution2-weak-self\" aria-label=\"Sloution2 weak self permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Sloution2. weak self</h3>\n<p>ì•½í•œ ì°¸ì¡°ë¥¼ í•˜ë©´ Reference countë¥¼ ì¦ê°€ì‹œí‚¤ì§€ ì•ŠìŠµë‹ˆë‹¤. <code class=\"language-text\">setupAutohide()</code> ë‚´ë¶€ì˜ í´ë¡œì €ì—ì„œ <code class=\"language-text\">DispatchWorkHolder</code>ë¥¼ ì¬ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— cycleì´ ìƒê¸´ë‹¤ê³  ìƒê°í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŠ” í´ë¡œì € êµ¬ë¬¸ì—ì„œ <code class=\"language-text\">weak self</code>ë¥¼ í†µí•´ í•´ê²°í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ ìƒê°í•˜ì˜€ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í˜„ì¬ <code class=\"language-text\">FullscreenPopup</code>ì€ êµ¬ì¡°ì²´ì…ë‹ˆë‹¤. êµ¬ì¡°ì²´ëŠ” ARCì˜ ëŒ€ìƒì´ ì•„ë‹ˆê³  ì•½í•œ ì°¸ì¡°ì˜ ê°œë…ì€ classì—ë§Œ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì´ëŠ” í•´ê²° ë°©ë²•ì´ ë  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤.</p>\n<h3 id=\"Solution3-ì§ì ‘-í• ë‹¹-í•´ì œ\" style=\"position:relative;\"><a href=\"#Solution3-%EC%A7%81%EC%A0%91-%ED%95%A0%EB%8B%B9-%ED%95%B4%EC%A0%9C\" aria-label=\"Solution3 ì§ì ‘ í• ë‹¹ í•´ì œ permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Solution3. ì§ì ‘ í• ë‹¹ í•´ì œ</h3>\n<p>Reference countë¥¼ ì¤„ì´ëŠ” ë°©ë²• ì¤‘ì— í•˜ë‚˜ë¡œ í•´ë‹¹ ê°ì²´ë¥¼ nilë¡œ ë°”ê¿”ì£¼ëŠ” ê²ƒì´ ìˆìŠµë‹ˆë‹¤. ìµœì¢…ì ìœ¼ë¡œ ìƒê°í•œ ë°©ë²•ìœ¼ë¡œ í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ ì‹œì ì— <code class=\"language-text\">DispatchWorkItem</code>ì„ nilë¡œ ë§Œë“¤ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">setupAutohide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// if needed, dispatch autohide and cancel previous one</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> autohideIn <span class=\"token operator\">=</span> autohideIn <span class=\"token punctuation\">{</span>\n        dispatchWorkHolder<span class=\"token punctuation\">.</span>work<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        <span class=\"token comment\">// Weak reference to avoid the work item capturing the struct,</span>\n        <span class=\"token comment\">// which would create a retain cycle with the work holder itself.</span>\n        \n        dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token operator\">=</span> <span class=\"token class-name\">DispatchWorkItem</span><span class=\"token punctuation\">(</span>block<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> isPresentedRef<span class=\"token punctuation\">,</span> <span class=\"token keyword\">weak</span> itemRef<span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n            isPresentedRef<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>wrappedValue <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n            itemRef<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>wrappedValue <span class=\"token operator\">=</span> <span class=\"token nil constant\">nil</span>\n            dismissSource <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>autohide\n            dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token operator\">=</span> <span class=\"token nil constant\">nil</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> sheetPresented<span class=\"token punctuation\">,</span> <span class=\"token keyword\">let</span> work <span class=\"token operator\">=</span> dispatchWorkHolder<span class=\"token punctuation\">.</span>work <span class=\"token punctuation\">{</span>\n            <span class=\"token class-name\">DispatchQueue</span><span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span><span class=\"token function\">asyncAfter</span><span class=\"token punctuation\">(</span>deadline<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> autohideIn<span class=\"token punctuation\">,</span> execute<span class=\"token punctuation\">:</span> work<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ì´ ë°©ë²•ì„ í†µí•´ cycleì„ ëŠê³  ëˆ„ìˆ˜ë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<p>![[./instruments-leaks-solve.png]]</p>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ë§ˆì¹˜ë©°</h2>\n<p>ë¹„ë¡ ì½”ë“œ í•œ ì¤„ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ì§€ë§Œ, í•´ê²°í•˜ëŠ” ê³¼ì •ì—ì„œ ì½”ë“œ ë¶„ì„, ë©”ëª¨ë¦¬ ê´€ë ¨, ì°¸ì¡° ê´€ë ¨ ê³µë¶€ë¡œë§Œ 1ì£¼ì¼ì€ ì‚¬ìš©í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤. í¬ê¸°í• ê¹Œë„ ìƒê°í–ˆì§€ë§Œ í•  ìˆ˜ ìˆì„ ê²ƒì´ë¼ëŠ” ìƒê°ê³¼ í•´ë‚´ê³  ë§ê² ë‹¤ëŠ” ì§‘ë… í•˜ë‚˜ë¡œ ê³„ì† ì§„í–‰í–ˆë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì¢‹ì€ ë°©ë²•ì¸ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆê³  ê²°ê³¼ì ìœ¼ë¡œ ì—„ì²­ë‚œ ê³µë¶€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ê°œë°œìë¡œì„œ í•œ ì¸µ ì„±ì¥í•˜ê³ , ê°œë°œí•˜ëŠ” ê²ƒì´ ë”ìš± ì¬ë°Œì–´ì§€ëŠ” ê²½í—˜ì´ì—ˆìŠµë‹ˆë‹¤.</p>\n<h2 id=\"ì°¸ê³ -ìë£Œ\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%9E%90%EB%A3%8C\" aria-label=\"ì°¸ê³  ìë£Œ permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>ì°¸ê³  ìë£Œ</h2>\n<ul>\n<li><a href=\"https://github.com/exyte/PopupView\">PopupView GitHub Repository</a></li>\n</ul>","frontmatter":{"title":"SwiftUI ë¼ì´ë¸ŒëŸ¬ë¦¬ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë¶„ì„ê³¼ í•´ê²°","date":"May 01, 2023","update":"January 18, 2025","tags":["Swift","iOS","SwiftUI","ë©”ëª¨ë¦¬"],"series":""},"fields":{"slug":"/swiftui-opensource-memory-leak-solve/","readingTime":{"minutes":10.515}}},"seriesList":{"edges":[{"node":{"id":"050f3c55-aa6a-53d0-b9c7-2a747e669f52","fields":{"slug":"/swiftui-opensource-memory-leak-solve/"},"frontmatter":{"title":"SwiftUI ë¼ì´ë¸ŒëŸ¬ë¦¬ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë¶„ì„ê³¼ í•´ê²°"}}},{"node":{"id":"2501fdf6-4ed2-5165-b0d5-ac98cc9644b6","fields":{"slug":"/monospaced-font/"},"frontmatter":{"title":"ê°œë°œ í™˜ê²½ì„ ìœ„í•œ ê³ ì •í­ ê¸€ê¼´"}}}]},"previous":null,"next":{"fields":{"slug":"/monospaced-font/"},"frontmatter":{"title":"ê°œë°œ í™˜ê²½ì„ ìœ„í•œ ê³ ì •í­ ê¸€ê¼´"}}},"pageContext":{"id":"050f3c55-aa6a-53d0-b9c7-2a747e669f52","series":"","previousPostId":null,"nextPostId":"2501fdf6-4ed2-5165-b0d5-ac98cc9644b6"}},"staticQueryHashes":[],"slicesMap":{}}